---
title: Use Clerk with Astro
description: Learn how to use Clerk to quickly and easily add secure authentication and user management to your Astro application.
---

# Astro Quickstart

<TutorialHero
  framework="astro"
  exampleRepo={[
    {
      title: "Astro Quickstart Repo",
      link: "https://github.com/clerk/clerk-astro-quickstart"

    }
  ]}
  beforeYouStart={[
    {
      title: "Set up a Clerk application",
      link: "https://clerk.com/docs/quickstarts/setup-clerk",
      icon: "clerk",
    }
  ]}
>

- Install @clerk/astro
- Set up your environment variables
- Add TypeScript declarations
- Update your Astro configuration
- Add middleware
- Create a header with Clerk
</TutorialHero>


<Steps>
### Install `@clerk/astro`

Clerk's Astro SDK has prebuilt components and helpers to make user authentication easier.

To get started using Clerk with Astro, add the SDK to your project:

<CodeBlockTabs type="installer" options={["npm", "yarn", "pnpm"]}>
  ```bash filename="terminal"
  npm install @astro/clerk
  ```

  ```bash filename="terminal"
  yarn add @astro/clerk
  ```

  ```bash filename="terminal"
  pnpm add @astro/clerk
  ```
</CodeBlockTabs>

### Set environment variables

Below is an example of your `.env` file.

**Pro tip!** If you are signed into your Clerk Dashboard, your secret key should become visible by clicking on the eye icon. Otherwise, you can find your keys in the Clerk Dashboard on the [API Keys](https://dashboard.clerk.com/last-active?path=api-keys) page.

<InjectKeys>

```sh filename=".env"
PUBLIC_CLERK_PUBLISHABLE_KEY={{pub_key}}
CLERK_SECRET_KEY={{secret}}
```

</InjectKeys>

### Update `.env.d.ts`

Inside your `src/` directory, update the `.env.d.ts` file to ensure that the locals added by the middleware are properly typed.

```ts filename="src/.env.d.ts" {3}
/// <reference path="../.astro/types.d.ts" />
/// <reference types="astro/client" />
/// <reference types="@clerk/astro/env" />
```

### Install `@astrojs/node` and optionally `@astrojs/react`

Install the [`@astrojs/node`](https://docs.astro.build/en/guides/integrations-guide/node/) adapter. This is required for the middleware to work.

If you wish to use the React version of the components and features from `@clerk/astro`, including the React examples below, also install `@astrojs/react`.

<CodeBlockTabs type="installer" options={["npm", "yarn", "pnpm"]}>
  ```bash filename="terminal"
  npx astro add node
  npx astro add react
  ```

  ```bash filename="terminal"
  yarn astro add node
  yarn astro add react
  ```

  ```bash filename="terminal"
  pnpm astro add node
 pnpm astro add react
  ```
</CodeBlockTabs>


### Update `astro.config.mjs`

To configure Clerk in your astro application, you will need to update your `astro.config.mjs`.

- Add the Clerk integration to the `integrations` list.
- Set `output` to `server`. This is required when deploying to a host supporting SSR.

```ts filename="astro.config.mjs" {3,7}
import { defineConfig } from "astro/config";
import node from "@astrojs/node";
import clerk from "@clerk/astro";

 // https://astro.build/config
export default defineConfig({
  integrations: [clerk()],
  output: "server",
  adapter: node({ mode: "standalone" }),
});
```

### Add middleware to your application

[`clerkMiddleware()`](TODO) grants you access to user authentication state throughout your application, on any route or page. It also allows you to protect specific routes from unauthenticated users. To add `clerkMiddleware()` to your application, follow these steps:

1. Create a `middleware.ts` file inside your `src/` directory.
2. In your `middleware.ts` file, export an `onRequest` constant and assign it to the result of the `clerkMiddleware` function.

```tsx filename="src/middleware.ts"
import { clerkMiddleware } from "@clerk/astro/server";

export const onRequest = clerkMiddleware();
```

3. By default, `clerkMiddleware()` will not protect any routes. All routes are public and you must opt-in to protection for routes. See the [`clerkMiddleware()` reference](/docs/references/astro/clerk-middleware) to learn how to require authentication for specific routes.

### Add components to your app

Clerk offers components that allow you to protect your pages. These components are used to control the visibility of your pages based on the user's authentication state.


<CodeBlockTabs options={["Astro", "React"]}>
  ```astro filename="src/layouts/SiteLayout.astro"
---
import { SignedIn, SignedOut } from "@clerk/astro/components/control";
import { UserButton } from "@clerk/astro/components/interactive";
import { SignInButton } from '@clerk/astro/components/unstyled'

const { title } = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
  </head>
  <body>
    <header>
      <h1>{title}</h1>
      <nav>
        <SignedOut>
         <SignInButton mode="modal" />
        </SignedOut>
        <SignedIn>
          <UserButton />
        </SignedIn>
      </nav>
    </header>
    <article>
      <slot />
    </article>
  </body>
  <style>
    h1 {
      font-size: 2rem;
    }
  </style>
</html>
```
</CodeBlockTabs>


<CodeBlockTabs options={["Astro", "React"]}>
  ```astro filename="src/pages/index.astro"
  ---
  import SiteLayout from "../layouts/SiteLayout.astro"
  ---
  <SiteLayout title="Clerk + Astro">
	  <p>Sign in to try Clerk out!</p>
  </SiteLayout>
  ```

  ```tsx filename="src/pages/index.tsx"
  import {
    SignInButton,
    SignedIn,
    SignedOut,
    UserButton
  } from '@clerk/astro/client/react'

  export default function Page() {
    return (
      <>
        <SignedOut>
          <SignInButton />
        </SignedOut>
        <SignedIn>
          <UserButton />
        </SignedIn>
      </>
    )
  }
  ```
</CodeBlockTabs>

</Steps>

## Next steps

<div className="container mx-auto my-4">
  <div className="grid grid-cols-1 gap-6 md:grid-cols-2">

    <Cards title="Protect routes using Clerk Middleware" description="Learn how to protect specific routes from unauthenticated users." link="/docs/references/astro/clerk-middleware" cta="Learn More" />

  </div>
</div>
